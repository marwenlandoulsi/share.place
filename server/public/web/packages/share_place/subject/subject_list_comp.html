<div *ngIf="selectedFolder != null" class="subjects">

  <material-popup *ngIf="infoPopupUser != null" [(visible)]="infoPopupOpen" [source]="userInfoPopup" [offsetX]="26">
    <div class="userInfoPopup">
      <div class="userInfo name"><span>{{infoPopupUser?.name}}</span></div>
      <div class="userInfo role">{{getRoleStr(infoPopupUser)}}</div>
      <div class="userInfo email">{{infoPopupUser?.email}}</div>


      <div *ngIf="infoPopupUser?.skype != null" class="userInfo skype"><span class="txtskype">Call:</span> <a
          href="{{skypeUrlFor(infoPopupUser ,true)}}"> {{infoPopupUser?.skype}} </a></div>
      <div *ngIf="infoPopupUser?.skype != null" class="userInfo skype"><span class="txtskype">Text:</span> <a
          href="{{skypeUrlFor(infoPopupUser ,false)}}"> {{infoPopupUser?.skype}} </a></div>


      <div class="userInfo timezone hidden"> Timezone UTC-7 9:24 am</div>

      <div class="userInfo lastcnx hidden">Last connection: 5 mn ago</div>
    </div>
  </material-popup>

  <div class="title">{{selectedFolder.name}}

    <postit-comp [name]="'invitePeople'" [header]="'Great!'"
                 [body]="'Now invite some poople to join you clicking on the + icon'"
                 class="subjectsPostit"></postit-comp>

    <btn (click)="add()"
         [sources]="['../images/add-poeple.png', '../images/add-poeple.png', '../images/add-poeple.png']"
         class="addBtn addpeople" [disabled]="selectedFolder==null"></btn>

    <modal [visible]="adding">
      <material-dialog defaultPopupSizeProvider
                       enforceSpaceConstraints
                       class="profilemenuvisible">
        <invite-users-dialog></invite-users-dialog>
      </material-dialog>
    </modal>
    <!-- emplacement des users  -->
    <ul class="users_list" popupSource
        #userInfoPopup="popupSource" alignPositionX="end"
        alignPositionY="after">
      <li *ngFor="let userItem of users" class="useractive" [class.approver]="isApprover(userItem)"
          (click)="userInfoRequested=userItem">
        <img src="/auth/user/photo/s/{{userItem.id}}">
      </li>
    </ul>
  </div>

  <div>
    <ul class="subjectList">
      <div class="newTopic">
        <div class="newTopicBlock">
          <input type="text" #text (keyup.enter)="createQuickNote(text.value);text.value='';"
                 placeholder="Start a topic..."
                 class="txt"/>
          <div (click)="createQuickNote(text.value);text.value=''" class="btn_valid"></div>
        </div>
      </div>
      <li *ngFor="let subject of subjects; let subjectIndex = index" (click)="gotoSubject(subject)" class="subjectItem"
          [class.qNote]="subject.dataType == 'quickNote'"
          [class.selected]="selectedSubject != null && subject.id == selectedSubject.id"
          [class.approved]="subject.approved != null"
          [class.locked]="subject.lockOwner != null"
          [class.ownAction]="subject.lockOwner?.userId == connectedUser.id"
      >
        <div *ngIf="renaming == null || renaming?.id != subject?.id" class="subject"
        >
          <div class="thumb"><img
              src="/sp/place/{{selectedPlace.id}}/folder/{{selectedFolder?.id}}/file/{{subject.fileId}}/version/{{subject.v}}/thumb">
          </div>
          <div class="name">{{subject.name}}</div>
          <div *ngIf="subject.dataType == 'file'" class="version"> V.{{subject.v}}</div>
          <div class="users">
            <ul>
              <li *ngFor="let activeUser of subject.users" class="user">
                <div class="profileImg" [class.validator]="activeUser.role == 'admin'"
                     (click)="showSubjectUserInfoPopup( activeUser.userId, subjectIndex, $event )"
                     popupSource alignPositionX="end"
                     alignPositionY="after" #subjectParticipant="popupSource">
                  <img src="/auth/user/photo/s/{{activeUser.userId}}">
                </div>
                <input *ngIf="renaming != null && renaming.id == subject?.id" type="text" #folderRenamer
                       value="{{subject.name}}"
                       (keydown.enter)="doRename(folderRenamer.value)" class="editSubject"/>
                <info-popup *ngIf="subjectIndex == subjectInfoPopupIndex && popupUserInfoId == activeUser.userId" [userId]="popupUserInfoId"
                            [source]="subjectParticipant" [offsetX]="28" [offsetY]="10" [visible]="popupUserInfoId == activeUser.userId" [parent]="self" [index]="subjectIndex"></info-popup>
              </li>
            </ul>
            <div class="clearfix"></div>
          </div>
        </div>
        <div class="clearfix"></div>
      </li>
    </ul>

    <form id="fileForm" #upload class="uploadDropZone"
          (dragenter)="upload.style.setProperty('border', '2px solid #9FC8FA')"
          (drop)="upload.style.setProperty('border', '2px dotted #273B54');">
      <label id="labelfileupload" for="fileupload"> Drag'n drop or browse file </label>
      <input type="file" id="fileupload" (change)="uploadFiles()" class="uploadFile" name="toUpload"
             style="opacity: 0"/>

      <postit-comp [name]="'files'" [header]="'Cool !'"
                   [body]="'Now you can Drag\'n drop a file here and start collaborate with your team '"
                   class="filesPostit"></postit-comp>
    </form>
  </div>
</div>